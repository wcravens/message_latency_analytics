---
title: "Inital Exploratory Data Analysis"
output: html_notebook
---

In this section we will attempt to gain some insight into the general nature 
of our data from mostly a descriptive statistics perspective through the use
of some visualizate and light calculations.  We aren't trying to discover the
exact mathematics that would result in good models for our observations.
Rather we are just trying to develop a modest but reasonable understanding of
our data. These results will help us determine how to focus our efforts
as we apply more rigorous (and expensive) techniques downstream to accurately
model the features and characteristics in our observations.

## Vizualizations concerning Event Arrival Time 

```{r viz-arrival_T}
hist( as.numeric( event_data$arrival_T ), breaks=120, col="blue", xlab = "Event Time in ns over the first two minutes of data.", main="Histogram of Event Freq per Sec" )

par(mfrow=c( 4, 1 ) )#, mai=c(0.1, 0.1, 0.1, 0.1) )
stripchart( as.numeric( head( event_data$arrival_T, 10000 ) ), pch=19, cex=0.5, col="blue", xlab="Event Time in ns", main="1-D Stripchart of Event Time; first 10000 observations." )
stripchart( as.numeric( head( event_data$arrival_T, 1000 ) ), pch=19, cex=0.5, col="blue", xlab="Event Time in ns", main="1-D Stripchart of Event Time; first 1000 observations." )
stripchart( as.numeric( head( event_data$arrival_T, 100 ) ), pch=19, cex=0.5, col="blue", xlab="Event Time in ns", main="1-D Stripchart of Event Time; first 100 observations." )
stripchart( as.numeric( head( event_data$arrival_T, 10 ) ), pch=19, cex=0.5, col="blue", xlab="Event Time in ns", main="1-D Stripchart of Event Time; first 10 observations." )
par( mfrow=c(1, 1) )

plot( head( event_data$arrival_T, 10000 ), head( event_data$delta_t, 10000 ), col="blue", pch=19, xlab="Event Time in ns", ylab="Inter-Event Delta_t in ns", main="Inter-Event Delta_t against Event Time" )
plot( head( event_data$arrival_T, 1000 ), head( event_data$delta_t, 1000 ), col="blue", pch=19, xlab="Event Time in ns", ylab="Inter-Event Delta_t in ns", main="Inter-Event Delta_t against Event Time" )
plot( head( event_data$arrival_T, 100 ), head( event_data$delta_t, 100 ), col="blue", pch=19, xlab="Event Time in ns", ylab="Inter-Event Delta_t in ns", main="Inter-Event Delta_t against Event Time" )
plot( head( event_data$arrival_T, 10 ), head( event_data$delta_t, 10 ), col="blue", pch=19, xlab="Event Time in ns", ylab="Inter-Event Delta_t in ns", main="Inter-Event Delta_t against Event Time" )
```

## Visualizations concering inter-event delta_t
```{r viz-delta_t}
. <- event_data %>%
  #slice( -1 ) %>%
  mutate( delta_t = replace_na( as.numeric( delta_t ), 0 ) ) %>%
  select( delta_t )
delta_t = .$delta_t

str(delta_t)
summary(delta_t)
describe(delta_t) 
acf(delta_t)
pacf(delta_t)

plot( event_data$arrival_T, delta_t, col="blue", pch=19, xlab="Event Time in ns", ylab="Inter-Event Delta_t in ns", main="Inter-Event Delta_t against Event Time" )

plot( head( delta_t, 1000 ), head( event_data$duration, 1000 ), pch=19, col="blue", xlab="Inter-Event Delta_t", ylab="Duration of Event in ns", main="Event Duration against Inter-Event Delta_t" )

hist( as.numeric( delta_t), col="blue", main="Histogram of Inter-event Delta_t", xlab="Delta_t in Nanoseconds")
hist( log( as.numeric( delta_t)), col="blue", main="Histogram of log( Inter-event Delta_t )", xlab="log(Delta_t) in Nanoseconds")

{
  qqnorm( as.numeric( delta_t ) )
  qqline(as.numeric(delta_t), distribution=qnorm)
}
{
  qqplot(x=qexp(ppoints(1000)), y=as.numeric(delta_t), main="Exponential Q-Q Plot",
         xlab="Theoretical Quantiles", ylab= "Delta_t Quantiles")
  qqline(as.numeric(delta_t), distribution=qexp)
}
```

## Visualizations concering the Number of Concurrent Events over Time (Queueing Process)
```{r explore_concurent_events}
in_queue <- event_data %>%
  filter( !is.na( departure_T ), departure_T != 0 ) %>%
  mutate( t = arrival_T, step = 1 ) %>%
  select( t, step )

out_queue <- event_data %>%
  filter( !is.na( departure_T ), departure_T != 0 ) %>%
  mutate( t = departure_T, step = -1 ) %>%
  select( t, step )

queue <- bind_rows( in_queue, out_queue ) %>%
  arrange( t ) %>%
  mutate( size = cumsum( step ))
  
plot( queue$t, queue$size, type="l", col="blue", pch=19, cex=0.5, main="Concurrent Event Count at Time t.", xlab='Time t in Nanoseconds', ylab="Concurrent event count" )
hist( log( queue$size ), col="blue", main="Histogram of log( Concurrent Event Count )", xlab="log( Concurrent Event Count )")
```
<!-- Scratch Notes Below
# H0 (null): The data was produced in a random manner.
# Ha (alternative): The data was not produced in a random manner.

# w/ p-value < 2.2e-16; THere is sufficien evidence to reject the Null Hypothesis. 

d1 <- msgw_in$inter_message_delta_t_ns
d2 <- msgw_in$message_processing_time_ns

runs.test( d1 ) 
chisq.test( d1 )
bartels.rank.test( d1 )
cox.stuart.test( d1 )
difference.sign.test( d1 )
acf( d1 ) 
pacf( d1 )

runs.test( d2 ) 
chisq.test( d2 )
bartels.rank.test( d2 )
cox.stuart.test( d2 )
difference.sign.test( d2 )
acf( d2 ) 
pacf( d2 )

    # Strip Charts at different times across the data set
    arrival_Times_slice_labels <- cut( numeric_arrival_Times, breaks=30*60, labels=F, include.lowest=T )
    arrival_Time_slices <- data.frame( numeric_arrival_Times, arrival_Times_slice_labels )
    par(mfrow=c( 30, 1 ), mai=c(0.1, 0.1, 0.1, 0.1) )
    loop_count <- 1:30
    for( i in loop_count ){
      stripchart( arrival_Time_slices$numeric_arrival_Times[ arrival_Time_slices$arrival_Times_slice_labels == i * 60 ], method="stack", pch=19, cex=0.5, col="blue", xlab=NULL, ylab=NULL, main=NULL, axes=F )
    }


EIplot( msgw_in$message_arrival_T_ns )
EIglm( numeric_arrival_Times )
EIglm( arrival_Time_slices$numeric_arrival_Times[ arrival_Time_slices$arrival_Times_slice_labels == 1 ] ) 
-->